import React, { useState, useEffect } from "react";
import * as BooksAPI from "../BooksAPI";
import BookTile from "./BookTile";
import { Link } from "react-router-dom";

const SearchPage = ({ handleValueChange, books }) => {
  const [query, setQuery] = useState("");
  const [searchBooks, setSearchBooks] = useState([]);

  useEffect(() => {
    if (
      SearchTerms.filter((term) => term.toLowerCase() === query.toLowerCase())
        .length > 0
    ) {
      BooksAPI.search(query, 20)
        .then((result) => {
          setSearchBooks(result);
        })
        .catch(() => setSearchBooks([]));
    } else setSearchBooks([]);
  }, [query]); // eslint-disable-line react-hooks/exhaustive-deps

  searchBooks.forEach((book) => {
    books.forEach((myBook) => {
      if (myBook.id === book.id) {
        book.shelf = myBook.shelf;
      }
    });
  });

  return (
    <div className="search-books">
      <div className="search-books-bar">
        <Link className="close-search" to="/">
          Close
        </Link>
        <div className="search-books-input-wrapper">
          <input
            type="text"
            placeholder="Search by title or author"
            value={query}
            onChange={(e) => setQuery(e.target.value)}
          />
        </div>
      </div>
      <div className="search-books-results">
        <ol className="books-grid">
          {searchBooks.map((book) => (
            <li key={book.id}>
              <BookTile book={book} handleValueChange={handleValueChange} />
            </li>
          ))}
        </ol>
      </div>
    </div>
  );
};

const SearchTerms = [
  "Android",
  "Art",
  "Artificial Intelligence",
  "Astronomy",
  "Austen",
  "Baseball",
  "Basketball",
  "Bhagat",
  "Biography",
  "Brief",
  "Business",
  "Camus",
  "Cervantes",
  "Christie",
  "Classics",
  "Comics",
  "Cook",
  "Cricket",
  "Cycling",
  "Desai",
  "Design",
  "Development",
  "Digital Marketing",
  "Drama",
  "Drawing",
  "Dumas",
  "Education",
  "Everything",
  "Fantasy",
  "Film",
  "Finance",
  "First",
  "Fitness",
  "Football",
  "Future",
  "Games",
  "Gandhi",
  "Homer",
  "Horror",
  "Hugo",
  "Ibsen",
  "Journey",
  "Kafka",
  "King",
  "Lahiri",
  "Larsson",
  "Learn",
  "Literary Fiction",
  "Make",
  "Manage",
  "Marquez",
  "Money",
  "Mystery",
  "Negotiate",
  "Painting",
  "Philosophy",
  "Photography",
  "Poetry",
  "Production",
  "Programming",
  "React",
  "Redux",
  "River",
  "Robotics",
  "Rowling",
  "Satire",
  "Science Fiction",
  "Shakespeare",
  "Singh",
  "Swimming",
  "Tale",
  "Thrun",
  "Time",
  "Tolstoy",
  "Travel",
  "Ultimate",
  "Virtual Reality",
  "Web Development",
  "iOS",
];

export default SearchPage;
